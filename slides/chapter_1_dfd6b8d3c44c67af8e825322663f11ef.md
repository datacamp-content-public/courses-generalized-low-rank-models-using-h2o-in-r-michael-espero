---
key: dfd6b8d3c44c67af8e825322663f11ef
title: 'Insert title here'
---

## Reconstruct Mixed Data

```yaml
type: TitleSlide
key: c029ff9c19
```

`@lower_third`
name: Michael Espero
title: Data Scientist

`@script`
In the last set of exercises you trained a generalized low rank model for the purpose of predicting missing values in a mixed data set. Now let's reconstruct the imperfect training data by imputing missing values of arbitrary variable type. To finish lesson 2, you will display the effectiveness of this approach by comparing the number of missing values present in the imperfect data frame we started with to the GLRM reconstructed data.

---

## The Missing Data Problem

```yaml
type: TwoColumns
key: 435009c0fe
```

`@part1`
"Why do missing data create such difficulty in scientific research? Because most data analysis procedures were not designed for them." - Schafer and Graham, 2002

- The Drawbacks of Row-Wise Omission

`@part2`
![](https://assets.datacamp.com/production/repositories/5309/datasets/fe062ae5a4b84d09fe3eecc646a3194b741eb127/missing%20data,%20binary%20code.jpg)

`@script`


`@citations`
Missing Data: Our View of the State of the Art

---

## The Missing Data Problem

```yaml
type: TwoRows
key: 9aea19b309
```

`@part1`
```
h2o.nacnt(train_w_missing) 
```

`@part2`
![](https://assets.datacamp.com/production/repositories/5309/datasets/e9d9dc6984fee43aa0429dfbcecd244027fbace4/Screen%20Shot%202019-08-18%20at%202.22.34%20PM.png)

`@script`


`@citations`
https://data.world/blab/b-corp-best-for-the-world-list

---

## The Missing Data Problem

```yaml
type: TwoRows
key: 66dbfd8137
```

`@part1`
```
library(DataExplorer)
plot_missing(as.tibble(train_w_missing))
```

`@part2`
![](https://assets.datacamp.com/production/repositories/5309/datasets/5fe1af78a4ac148758baae6780f8a49bdae0afee/Screen%20Shot%202019-08-18%20at%201.59.25%20PM.png)

`@script`


`@citations`
Boxuan Cui (2019). DataExplorer: Automate Data Exploration and Treatment. R package version 0.8.0. https://CRAN.R-project.org/package=DataExplorer

---

## "Borrow strength from what was observed."

```yaml
type: FullSlide
key: c9049edaba
code_zoom: 100
```

`@part1`
![](https://assets.datacamp.com/production/repositories/5309/datasets/dc30de6e823a334afc7f8c45c82edace02c08f14/Tutorial%20on%20Visualization%20with%20Generalized%20Low%20Rank%20Models.png)

`@script`
Recall that generalized low rank models "borrow strength" from what was observed to predict what wasn't.

`@citations`
Dr. Madeleine Udell, 2019

---

## Compress what was observed into 2 matrices.

```yaml
type: FullSlide
key: 8f2ee66b73
disable_transition: false
```

`@part1`
![](https://assets.datacamp.com/production/repositories/5309/datasets/2620bd81d3825c1ae39b1745d3a9c46d94a39198/glrm_matrix_decomposition.png)

`@script`
We accomplished this by compressing observed dataset "A" with rows "m" and columns "n" into a long "X" matrix and a wide "Y matrix". As you can see, the width of the X matrix is "k" columns wide and the height of the Y matrix is "k rows long"

`@citations`
H2O.AI

---

## Impute Missing Values

```yaml
type: FullSlide
key: 33e2639037
```

`@part1`
![Borrow Strength](https://assets.datacamp.com/production/repositories/5309/datasets/8dc00c4c27fc964086c107a1c80e7e92e5baf39c/Imputation.jpg)

`@script`
Now we're going to use the last GLRM we made to impute missing data.

`@citations`
Travel Time Reliability Reference Manual

---

## Recognize the model trained for imputation.

```yaml
type: FullSlide
key: cd8c763b88
```

`@part1`
```
b_corp_glrm <- h2o.glrm(
			training_frame = train,
            k = 64,
            seed = 143
)
```

`@script`
Here's the G-L-R-M you trained in the last exercise with rank 64. It's available in the enviornment as a H2O-Dim_Reduction-Model.

---

## Use your GLRM to impute missing values

```yaml
type: TwoRows
key: 2268b98219
```

`@part1`
```
b_corp_glrm <- h2o.glrm(
			training_frame = train,
            k = 64,
            seed = 143
)
```

`@part2`
```
glrm_imputed_data <- h2o.reconstruct(
			b_corp_glrm,
            train)
```

`@script`


`@citations`
Now we're going to use h2o's reconstruct keyword, applying the GLRM imputation model to impute missing values. The result should be a new version of the original, imperfect training data- this time free from missing values.

---

## Did the GLRM make a difference?

```yaml
type: TwoRows
key: bff2c401bd
```

`@part1`
```
h2o.nacnt(train_w_missing) 
```
![](https://assets.datacamp.com/production/repositories/5309/datasets/e9d9dc6984fee43aa0429dfbcecd244027fbace4/Screen%20Shot%202019-08-18%20at%202.22.34%20PM.png)

`@part2`
```
h2o.nacnt(glrm_imputed_data) 
```
![](https://assets.datacamp.com/production/repositories/5309/datasets/cdedce86f94b48a01e5c6ce423b0bc6d553faf0b/Screen%20Shot%202019-08-18%20at%202.25.21%20PM.png)

`@script`


---

## Visualize missing values in mixed data.

```yaml
type: FullSlide
key: 1687fc8f3b
```

`@part1`
```
plot_missing(as.tibble(reconstructed_frame))
```

`@script`
We can apply the plot_missing keyword from the DataExplorer package to display any missing values in the reconstructed training set.

`@citations`
Boxuan Cui (2019). DataExplorer: Automate Data Exploration and Treatment. R package version 0.8.0. https://CRAN.R-project.org/package=DataExplorer

---

## Not a NA in sight.

```yaml
type: FullSlide
key: b83544a1f7
```

`@part1`
![](https://assets.datacamp.com/production/repositories/5309/datasets/dcbf398c17d12761bd3ae55599813d896ffe7a67/Screen%20Shot%202019-08-18%20at%201.49.20%20PM.png)

`@script`


---

## It's your turn to impute missing values in mixed data!

```yaml
type: FinalSlide
key: da08020f2b
```

`@script`
