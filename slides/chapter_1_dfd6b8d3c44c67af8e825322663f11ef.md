---
key: dfd6b8d3c44c67af8e825322663f11ef
title: 'Insert title here'
---

## Reconstruct Mixed Data

```yaml
type: TitleSlide
key: c029ff9c19
```

`@lower_third`
name: Michael Espero
title: Data Scientist

`@script`
In the last set of exercises you trained a GLRM for the purpose of predicting missing values in a mixed data set. Now let's reconstruct the imperfect training data set by imputing missing values of arbitrary variable type. To finish lesson 2, you will use a heatmap to display the effectiveness of this approach.

---

## "Borrow strength from what was observed."


```yaml
type: FullSlide
key: c9049edaba
code_zoom: 100
```

`@part1`
![](https://assets.datacamp.com/production/repositories/5309/datasets/dc30de6e823a334afc7f8c45c82edace02c08f14/Tutorial%20on%20Visualization%20with%20Generalized%20Low%20Rank%20Models.png)

`@script`
Recall that generalized low rank models "borrow strength" from what was observed to predict what wasn't. 

`@citations`
Dr. Madeleine Udell, 2019

---

## Compress what was observed into 2 matrices.


```yaml
type: FullSlide
key: 8f2ee66b73
disable_transition: false
```

`@part1`
![](https://assets.datacamp.com/production/repositories/5309/datasets/2620bd81d3825c1ae39b1745d3a9c46d94a39198/glrm_matrix_decomposition.png)

`@script`
We accomplished this by compressing observed dataset "A" with rows "m" and columns "n" into a long "X" matrix and a wide "Y matrix". As you can see, the width of the X matrix is "k" columns wide and the height of the Y matrix is "k rows long"

`@citations`
H2O.AI

---

## Impute Missing Values

```yaml
type: FullSlide
key: 33e2639037
```

`@part1`
![Borrow Strength](https://assets.datacamp.com/production/repositories/5309/datasets/8dc00c4c27fc964086c107a1c80e7e92e5baf39c/Imputation.jpg)

`@script`
Now we're going to use the last GLRM we made to impute missing data. 

`@citations`
Travel Time Reliability Reference Manual

---

## Recall the model trained for imputation.

```yaml
type: FullSlide
key: cd8c763b88
```

`@part1`
```
finance_glrm_impute <- h2o.glrm(
	training_frame = finance_train, 
	validation_frame = finance_test,
    k = 10
)
```

`@script`


`@citations`
Here's the code you used to build a GLRM with rank 10 for imputation of missing values in a finance data set. 

---

## Use your GLRM to impute missing values

```yaml
type: TwoRows
key: 2268b98219
```

`@part1`
```
finance_glrm_impute <- h2o.glrm(
	training_frame = finance_train, 
	validation_frame = finance_test,
    k = 10
)
```

`@part2`
```
finance_train_reconstructed <- h2o.reconstruct(
			finance_glrm_impute,
            finance_train)
```

`@script`


`@citations`
Now we're going to use h2o's reconstruct keyword, applying the GLRM imputation model to impute missing values. The result should be a new version of the original, imperfect training data- this time free from missing values.

---

## Use a heatmap to visualize missing values.

```yaml
type: FullSlide
key: 1687fc8f3b
```

`@part1`
```
library(superheat)

superheat(
	finance_train_reconstructed,
    scale = TRUE,
    heat.pal = c("blue", "red"))
```

`@script`
We can apply the superheat keyword from the superheat package to display any missing values in the reconstructed training set. To make comparison easier, we'll standardize the reconstructed data to mean 0 and standard deviation 1 by setting scale to "TRUE". Finally, let's set the color palette so variables with fewer missing values are blue and variables with more missing values are red. 

`@citations`
https://rlbarter.github.io/superheat/basic-usage.html

---

## Ice Cold Heatmap

```yaml
type: FullSlide
key: b83544a1f7
```

`@part1`
![](https://assets.datacamp.com/production/repositories/5309/datasets/e9737c5988829497a03eaf6da33b4ba579ca066a/Screen%20Shot%202019-08-17%20at%205.58.39%20PM.png)

`@script`


`@citations`
(To be replaced with heatmap based on data used for lesson.)

---

## Let's impute missing values for mixed data!

```yaml
type: FinalSlide
key: da08020f2b
```

`@script`
